<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="Lab1.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
            $(document).ready(function() {
                console.log("in outer function");
                $("#textMessage").on('keydown', function(e) {
                    console.log("inside function");
                    var stringsTyped = $.trim(this.value).length ? this.value.match(/\S+/g).length : 0;
                    if (words <= 25) {                        
                        $('#words_left').text(25 - stringsTyped);
                        console.log("subtracting a word");
                    }else{
                        if (e.which !== 8) e.preventDefault();
                        console.log("in the else statement");
                    }
                });
            });       
        </script>            
           <script>
            function validateData(){
                var pwd = document.getElementById("passWord").value;
                var studentID = document.getElementById("studID").value;
                var user  = document.getElementById("username").value;                
                var vUser = validateUsername(user);
                var vId = validateStudID(studID);
                var vPwd = validatePwd(pwd);
                
                validateFailure(vUser, vId, vPwd);
            }
            
            function validateUsername(user){
                let lettersOnly = /[^a-zA-Z]+$/; //regular expression to ensure letters only

                if(user.length <= 0){
                    console.log("username field is empty");
                    return 0;
                }

                if(user.search(lettersOnly) == -1){
                    console.log("Username is all letters");                
                    return 1;
                } else {
                    console.log("username is NOT all letters");
                    return 0;
                }
            }
            
            function validateStudID(studentID){
                let digitOnly = /^[0-9]+$/; //regEx to ensure digits only
                var id = studentID.toString();
                if(id.length < 9){
                    console.log("studentID is too short"); 
                    return 0;
                }

                if(id.search(digitOnly) == -1){
                    console.log("studentID is all digits");                
                    return 1;
                } else {
                    console.log("studentID is NOT all digits");
                    return 0;
                }
            }
            
            function validatePwd(pwd){
                var fails = new Array(3).fill(0);
                let dig = /\d/;
                let upper = /[A-Z]/;
                let lower = /[a-z]/;
                if (pwd.search(dig) == -1) {
                    fails[0] = 1; //check that there is at least one number
                    console.log("needs a number");
                }
                if (pwd.search(lower) == -1) {
                    fails[1] = 1; //check there is at least one lowercase
                    console.log("needs a lowercase");
                }
                if (pwd.search(upper) == -1) {
                    fails[2] = 1; //check there is at least one uppercase
                    console.log("needs an uppercase");
                } 
                return fails;
            }
            
            function validateFailure(vUser,vId,vPwd){
                var fail = 0;
                if(vId == 0){
                    //display error for Student ID
                    document.getElementById("studIDImg").style.visibility = "visible";
                    fail++;
                }
                if(vUser == 0){
                    //display error for Username
                    document.getElementById("userImg").style.visibility = "visible";
                    fail++;
                }
                //for Password check through the 3 possibilities for failure
                if(vPwd[0] == 1){
                    fail++;
                    //number check failed
                    document.getElementById("pwdDigitFail").style.visibility = "visible";
                }
                if(vPwd[1] == 1){
                    fail++;
                    //lowercase check failed
                    document.getElementById("pwdLowerFail").style.visibility = "visible";
                }
                if(vPwd[2] == 1){
                    fail++;
                    //uppercase check failed
                    document.getElementById("pwdUpperFail").style.visibility = "visible";
                }
                
                if(fail > 0){
                    //something failed, deploy failure mode
                    document.body.style.backgroundColor = "red";
                    
                } else {                    
                    document.getElementById("successImg").style.visibility = "visible";
                }
            }  
        </script>
    </head>
    <body>
        <div class = "wrapper">
            <div class="formsdiv">
                <form >
                    <label for="username">Username:</label>
                    <input type="text" id="username" name="username"><br><br>
                    <label for="passWord">Password:</label>            
                    <input type="password" id="passWord" name="passWord" minlength="3"><br><br>
                    <label for="studID">Student ID:</label>
                    <input type="text" id="studID" name="studID"><br><br> 
                    <label for="textMessage">Message:</label>                    
                </form>
                <br><textarea id="textMessage" name="textMessage" rows="4" cols="50"></textarea>
                <br>Words Left: <span id="words_left">25</span><br>
                <button type="button" onclick="validateData()">Submit</button> 
            </div>
            <div class = "textarea">

            </div>
            <div class = “images”>
                <img id = "successImg" src="success.jpg" alt="TorresSuccessImage">
                <img id = "userImg" src= "usernameFail.png" alt ="TorresUsernameFail">
                <img id = "pwdDigitFail" src= "pwdDigitFail.png" alt ="TorresPasswordFail">
                <img id = "pwdLowerFail" src= "pwdLowerFail.png" alt ="TorresPasswordFail">
                <img id = "pwdUpperFail" src= "pwdUpperFail.png" alt ="TorresPasswordFail">
                <img id = "studIDImg" src= "studIDFail.png" alt ="TorresIDFail">
            </div>       
        </div>

    </body>
</html>